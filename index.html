<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portal do Negociador</title>
    <!-- Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600;700;800&family=Inter:wght@400;500;600&display=swap"
        rel="stylesheet">
    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
    <!-- SheetJS (New Import) -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    <!-- Custom -->
    <link rel="stylesheet" href="styles.css">
</head>

<body>

    <!-- 1. CENTERED HERO SPLASH -->
    <div id="splash-screen">
        <div class="splash-hero">
            <h1 class="splash-h1">SEJA BEM-VINDO AO</h1>
            <h2 class="splash-h2">PORTAL DO NEGOCIADOR</h2>
            <button class="btn-splash" onclick="Layout.enterApp()">ACESSAR PORTAL</button>
            <div style="margin-top: 40px; font-size: 13px; color:rgba(255,255,255,0.4);">
                Desenvolvido by Alanis Mendonça | Versão 10.1 (Monitoria)
            </div>
        </div>
    </div>

    <!-- 2. MAIN APP -->
    <div id="app-container" class="app-view">
        <nav class="top-nav">
            <button class="menu-trigger" onclick="Layout.toggleMenu()"><i class="bi bi-list"></i></button>
        </nav>

        <div class="home-container">
            <!-- Home Cards Grid -->
            <div id="home-grid-render" class="cards-grid">
                <!-- Rendered by JS -->
            </div>

            <!-- Admin Add Card Button (Grid Level) -->
            <button id="btn-add-home-card" class="btn-adm-add" style="display:none;"
                onclick="Admin.modals.openHomeCardEditor()">+ ADICIONAR CARD HOME</button>
        </div>
    </div>

    <!-- 3. SIDEBAR MENU -->
    <div class="offcanvas offcanvas-start sidebar-custom" tabindex="-1" id="mainMenu">
        <div class="menu-header">
            <span>MENU</span>
            <button id="btn-edit-menu" class="btn btn-sm btn-outline-warning" style="display:none;"
                onclick="Admin.modals.openMenuManager()"><i class="bi bi-pencil"></i></button>
        </div>
        <div class="menu-scroll-area" id="menu-list-render">
            <!-- Rendered by JS -->
        </div>
    </div>

    <!-- 4. CONTENT OVERLAY -->
    <div id="content-overlay" class="content-overlay">
        <div class="content-head">
            <button class="btn-back" onclick="Layout.closeSection()"><i class="bi bi-chevron-left"></i> VOLTAR PARA O
                MENU</button>
            <div id="section-title-display"
                style="font-family:'Montserrat'; font-weight:800; color:white; font-size:16px;">TÍTULO</div>
            <div style="width: 20px;"></div>
        </div>
        <div class="content-body">
            <!-- Extra: Monitoria Import Button (Hidden by default) -->
            <div id="monitoria-tools" style="display:none; margin-bottom: 20px;">
                <button class="btn btn-sm btn-outline-info w-100" onclick="Monitor.openImportModal()"><i
                        class="bi bi-file-earmark-spreadsheet"></i> IMPORTAR PLANILHA MONITORIA</button>
            </div>

            <!-- Blocks Container -->
            <div id="content-blocks-render">
                <!-- Rendered by JS -->
            </div>

            <!-- Admin: Add Block Button -->
            <button id="btn-add-block" class="btn-adm-add" style="display:none;" onclick="Admin.actions.addBlock()">+
                ADICIONAR BLOCO DE TEXTO</button>
        </div>
    </div>

    <!-- ADMIN UI FLOATING -->
    <div id="admin-badge" class="admin-badge">MODO GERENCIAL</div>
    <button class="admin-gear-fixed" onclick="Admin.ui.toggleLogin()"><i class="bi bi-gear-fill"></i></button>

    <!-- MODALS AREA -->

    <!-- Login -->
    <div class="modal fade modal-dark" id="loginModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered modal-sm">
            <div class="modal-content">
                <div class="modal-body p-4 text-center">
                    <h6 class="mb-3">Acesso Admin</h6>
                    <input type="password" id="pass-input" class="form-control mb-3 text-center" placeholder="Senha">
                    <button onclick="Admin.auth.login()" class="btn btn-warning w-100 fw-bold">ENTRAR</button>
                    <!-- Import/Export Tools -->
                    <div id="admin-tools-panel"
                        style="display:none; margin-top:20px; border-top:1px solid #333; padding-top:10px;">
                        <button onclick="Data.export()" class="btn btn-sm btn-outline-light w-100 mb-2">Exportar
                            JSON</button>
                        <button onclick="Data.reset()" class="btn btn-sm btn-outline-danger w-100 mb-2">Resetar
                            Padrão</button>
                        <button onclick="document.getElementById('file-upload').click()"
                            class="btn btn-sm btn-outline-light w-100 mb-2">Importar JSON</button>
                        <input type="file" id="file-upload" style="display:none" onchange="Data.import(this)">
                        <button onclick="Admin.auth.logout()" class="btn btn-sm btn-outline-danger w-100">Sair</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Monitoria Import Modal -->
    <div class="modal fade modal-dark" id="monitoriaImportModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Importar Checklist Monitoria</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label class="form-label text-muted">Selecione arquivo (.xlsx, .csv)</label>
                        <input type="file" id="monitor-file-upload"
                            class="form-control text-white bg-dark border-secondary" accept=".xlsx, .csv">
                    </div>

                    <div id="monitor-preview-area" style="display:none;">
                        <h6 class="text-info mt-3">Prévia (10 linhas)</h6>
                        <div class="table-responsive"
                            style="max-height: 200px; border:1px solid #333; margin-bottom:1rem;">
                            <table class="table table-dark table-sm table-bordered m-0" id="monitor-preview-table"
                                style="font-size:12px;"></table>
                        </div>

                        <div class="row g-2 mb-3">
                            <div class="col-6">
                                <label class="small text-muted">Coluna Critério *</label>
                                <select id="col-criterio"
                                    class="form-select form-select-sm bg-dark text-white border-secondary"></select>
                            </div>
                            <div class="col-6">
                                <label class="small text-muted">Coluna Peso *</label>
                                <select id="col-peso"
                                    class="form-select form-select-sm bg-dark text-white border-secondary"></select>
                            </div>
                            <div class="col-4">
                                <label class="small text-muted">Coluna Categoria</label>
                                <select id="col-cat"
                                    class="form-select form-select-sm bg-dark text-white border-secondary"></select>
                            </div>
                            <div class="col-4">
                                <label class="small text-muted">Coluna Descrição</label>
                                <select id="col-desc"
                                    class="form-select form-select-sm bg-dark text-white border-secondary"></select>
                            </div>
                            <div class="col-4">
                                <label class="small text-muted">Coluna Exemplo</label>
                                <select id="col-ex"
                                    class="form-select form-select-sm bg-dark text-white border-secondary"></select>
                            </div>
                        </div>

                        <button onclick="Monitor.processImport()" class="btn btn-success w-100">CONFIRMAR
                            IMPORTAÇÃO</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Generic Text Editor Modal -->
    <div class="modal fade modal-dark" id="textEditorModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Editar Conteúdo</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <label class="small text-muted mb-1">HTML/Texto</label>
                    <textarea id="editor-textarea" class="form-control mb-3" rows="8"></textarea>
                    <button onclick="Admin.actions.saveTextEdit()" class="btn btn-success w-100">SALVAR</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Home Card Editor -->
    <div class="modal fade modal-dark" id="cardEditorModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Editar Card Home</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <input type="text" id="card-edit-title" class="form-control mb-2" placeholder="Título">
                    <input type="text" id="card-edit-desc" class="form-control mb-2" placeholder="Descrição">
                    <input type="text" id="card-edit-tag" class="form-control mb-2" placeholder="Tag (ex: SCRIPT)">
                    <select id="card-edit-link" class="form-control mb-3"></select>
                    <button onclick="Admin.actions.saveHomeCard()" class="btn btn-success w-100">SALVAR CARD</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Menu Manager Modal -->
    <div class="modal fade modal-dark" id="menuManagerModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Gerenciar Menu</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div id="menu-manager-list" class="d-flex flex-column gap-2 mb-3"
                        style="max-height:300px; overflow-y:auto;"></div>
                    <hr>
                    <h6>Novo Item</h6>
                    <input type="text" id="new-menu-label" class="form-control mb-2" placeholder="Nome do Item">
                    <input type="text" id="new-menu-key" class="form-control mb-2"
                        placeholder="ID da Seção (ex: novas_regras)">
                    <button onclick="Admin.actions.addMenuItem()" class="btn btn-success w-100">ADICIONAR ITEM</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Subitem (Accordion) Editor -->
    <div class="modal fade modal-dark" id="subitemEditorModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Editar Subitem (Accordion)</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <input type="text" id="sub-edit-title" class="form-control mb-2" placeholder="Título do Botão">
                    <textarea id="sub-edit-body" class="form-control mb-3" rows="6"
                        placeholder="Conteúdo ao abrir..."></textarea>
                    <button onclick="Admin.actions.saveSubItem()" class="btn btn-success w-100">SALVAR</button>
                </div>
            </div>
        </div>
    </div>


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="app.js"></script>
</body>

</html>